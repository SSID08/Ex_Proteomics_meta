  ---
title: "Untitled"
author: "Siddharth"
date: '2022-09-12'
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
#load libraries
library(readxl)
library(impute)
library(vsn)
library(limma)
library(purrr)
library(ggplot2)
library(ggfortify)
library(reshape)
library(heatmaply)
library(DEqMS)
library(STRINGdb)
library(clusterProfiler)
library(org.Hs.eg.db)
library(enrichplot)
library(ReactomePA)
library(EnhancedVolcano)
```

```{r}
library(dplyr)
library(tidyverse)
```

```{r}
background_map=mapIds(org.Hs.eg.db,keys=Mito_Gene_to_UniProt$Gene,column="ENTREZID",keytype = "SYMBOL")%>%enframe()%>%drop_na()
background_map=background_map%>%distinct(name,.keep_all = T)
background_map=background_map%>%rename("ENTREZID"=2)
```

```{r}
background_map_Uniprot=mapIds(org.Hs.eg.db,keys = Mito_Gene_to_UniProt$Uniprot,column = "ENTREZID",keytype = "UNIPROT")%>%enframe()%>%drop_na()
background_map_Uniprot=background_map_Uniprot%>%rename("ENTREZID"=2)
```


```{r}
Javi_MCIT=data.frame(readRDS("../Javi analysis/Javi_MCIT_unnorm_with_DeQMS"))
Javi_SIT=data.frame(readRDS("../Javi analysis/Javi_SIT_unnorm_with_DeQMS"))
Javi_SIT_norm=data.frame(readRDS("../Javi analysis/Javi_SIT_normalized_with_DEqMS"))
Javi_MCIT_norm=data.frame(readRDS("../Javi analysis/Javi_MCIT_normalized_with_DEqMS"))
Granata_NVT=data.frame(readRDS("../Granata_analysis/NVT_Granata_with_DEqMS_unnormalized"))
Granata_HVT=data.frame(readRDS("../Granata_analysis//HVT_Granata_with_DeqMS_unnormalized"))
Deshmukh_df=data.frame(readRDS("../Deshmukh_2021_analysis/Deshmukh_unnormalized_mito"))
Deshmukh_df_norm=data.frame(readRDS("../Deshmukh_2021_analysis/Deshmukh_normalized_mito"))
Hostrup_df=data.frame(readRDS("../Hostrup_2021_analysis/Hostrup_DEQMS_unnorm"))
Hostrup_df_norm=data.frame(readRDS("../Hostrup_2021_analysis/Hostrup_DEQMS_norm"))
Granata_NVT_norm=data.frame(readRDS("../Granata_analysis//NVT_Granata_with_DeqMS"))
Granata_HVT_norm=data.frame(readRDS("../Granata_analysis//HVT_Granata_with_DeqMS"))
Schild_df=data.frame(readRDS("../Schild_analysis/DeQMS_Schild_unnormalized_mito"))
Schild_norm_df=data.frame(readRDS("../Schild_analysis/DeQMS_Schild_normalized_mito"))
```

```{r}
Mito_Gene_to_UniProt=readxl::read_xlsx(path = "../Gene_to_Uniprot.xlsx")
Mito_Gene_to_UniProt=Mito_Gene_to_UniProt%>%rename(c("Uniprot"="Entry","Gene"="From"))
```

```{r}
Javi_MCIT=dplyr::left_join(Javi_MCIT,background_map_Uniprot,by=c("Uniprot"="name"))
Javi_SIT=dplyr::left_join(Javi_SIT,background_map_Uniprot,by=c("Uniprot"="name"))
Javi_MCIT_norm=dplyr::left_join(Javi_MCIT_norm,background_map_Uniprot,by=c("Uniprot"="name"))
Javi_SIT_norm=dplyr::left_join(Javi_SIT_norm,background_map_Uniprot,by=c("Uniprot"="name"))
Granata_HVT=left_join(Granata_HVT,background_map_Uniprot,by=c("Uniprot"="name"))
Granata_NVT=left_join(Granata_NVT,background_map_Uniprot,by=c("Uniprot"="name"))
Deshmukh_df=left_join(Deshmukh_df,background_map,by=c("Gene"="name"))
Deshmukh_df_norm=left_join(Deshmukh_df_norm,background_map,by=c("Gene"="name"))
Hostrup_df=left_join(Hostrup_df,background_map,by=c("Gene"="name"))
Hostrup_df_norm=left_join(Hostrup_df_norm,background_map,by=c("Gene"="name"))
Granata_NVT_norm=left_join(Granata_NVT_norm,background_map_Uniprot,by=c("Protein_IDs"="name"))
Granata_HVT_norm=left_join(Granata_HVT_norm,background_map_Uniprot,by=c("Protein_IDs"="name"))
Schild_df=left_join(Schild_df,background_map_Uniprot,by=c("Uniprot"="name"))
```

```{r}
Deshmukh_df=Deshmukh_df%>%left_join(.,background_map_Uniprot,by=c("Protein_IDs"="name"))
Deshmukh_df=Deshmukh_df%>%mutate(ENTREZID=coalesce(ENTREZID.x,ENTREZID.y))%>%select(-ENTREZID.x,-ENTREZID.y)
```

```{r}
Deshmukh_df_norm=Deshmukh_df_norm%>%left_join(.,background_map_Uniprot,by=c("Protein_IDs"="name"))
Deshmukh_df_norm=Deshmukh_df_norm%>%mutate(ENTREZID=coalesce(ENTREZID.x,ENTREZID.y))%>%select(-ENTREZID.x,-ENTREZID.y)
```


```{r}
Hostrup_df=Hostrup_df%>%left_join(.,background_map_Uniprot,by=c("Uniprot"="name"))
Hostrup_df=Hostrup_df%>%mutate(ENTREZID=coalesce(ENTREZID.x,ENTREZID.y))%>%select(-ENTREZID.x,-ENTREZID.y)
```

```{r}
Hostrup_df_norm=Hostrup_df_norm%>%left_join(.,background_map_Uniprot,by=c("Uniprot"="name"))
Hostrup_df_norm=Hostrup_df_norm%>%mutate(ENTREZID=coalesce(ENTREZID.x,ENTREZID.y))%>%select(-ENTREZID.x,-ENTREZID.y)
```


```{r}
Javi_MCIT_DE=Javi_MCIT%>%filter(Javi_MCIT_sca.P.Value<=0.01 & Javi_MCIT_logFC>0)%>%select(ENTREZID,Javi_MCIT_logFC)%>%deframe()
Javi_SIT_DE=Javi_SIT%>%filter(Javi_SIT_sca.P.Value<=0.01 & Javi_SIT_logFC>0)%>%select(ENTREZID,Javi_SIT_logFC)%>%deframe()
Granata_HVT_DE=Granata_HVT%>%filter(HVT_Granata_sca.P.Value<=0.01 & HVT_Granata_logFC>0)%>%select(ENTREZID,HVT_Granata_logFC)%>%deframe()
Granata_NVT_DE=Granata_NVT%>%filter(NVT_Granata_sca.P.Value<=0.01 & NVT_Granata_logFC>0)%>%select(ENTREZID,NVT_Granata_logFC)%>%deframe()
Deshmukh_DE=Deshmukh_df%>%filter(Deshmukh_sca.P.Value<=0.01 & Deshmukh_logFC>0)%>%select(ENTREZID,Deshmukh_logFC)%>%deframe()
Hostrup_DE=Hostrup_df%>%filter(Hostrup_sca.P.Value<=0.01 & Hostrup_logFC>0)%>%select(ENTREZID,Hostrup_logFC)%>%deframe()
```

```{r}
#png("Unnorm_mito_Volcano_plot.png",width = 8,height = 7,units = "in",res=800)
EnhancedVolcano(Granata_HVT,x="logFC",y="sca.P.Value",lab = Granata_HVT$gene, pCutoff = 0.01,FCcutoff = 0.75,colAlpha = 0.8,pointSize = 1.5,drawConnectors = T,max.overlaps = 20,labSize = 1.5,axisLabSize = 10)
#dev.off()
```
```{r}
compare_list=list(names(Javi_MCIT_DE),names(Javi_SIT_DE),names(Granata_NVT_DE),names(Granata_HVT_DE),names(Deshmukh_DE),names(Hostrup_DE))
names(compare_list)=c("Javi_MCIT","Javi_SIT","Granata_NVT","Granata_HVT","Deshmukh_DE","Hostrup_DE")
```

```{r}
ck_BP=compareCluster(geneClusters=compare_list,fun = "enrichGO",ont="BP",readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.01,minGSSize=30)
```

```{r}
ck_Reactome=compareCluster(geneClusters=compare_list,fun = "enrichPathway",readable=T,organism="human",pvalueCutoff=0.01,minGSSize=30)
```


```{r}
#png("Comparative_upregulated_plot.png",width = 5,height = 7,units = "in",res = 600)
dotplot(ck_Reactome,includeAll=T,font.size=9,showCategory=15)
dotplot(ck_BP,includeAll=T,font.size=5,showCategory=18)
#dev.off()
```

```{r}
#cnetplot(ck_BP%>%filter(Cluster=="Deshmukh_DE"),foldChange =Deshmukh_DE,showCategory=10,cex_label_gene=0.6,cex_category=1.2,node_label="category")
```

```{r}
Deshmukh_compare=list(names(Deshmukh_df_norm%>%filter(Deshmukh_logFC>0 & Deshmukh_sca.P.Value<=0.01)%>%select(ENTREZID,Deshmukh_logFC)%>%deframe()),names(Deshmukh_df_norm%>%filter(Deshmukh_sca.P.Value<=0.01 & Deshmukh_logFC<0)%>%select(ENTREZID,Deshmukh_logFC)%>%deframe()))
names(Deshmukh_compare)=c("Upregulated","Downregulated")
```


```{r}
Deshmukh_GSEA=gsePathway(Deshmukh_df%>%select(ENTREZID,Deshmukh_logFC)%>%arrange(desc(Deshmukh_logFC))%>%deframe(),organism = "human",minGSSize = 30,pvalueCutoff = 0.25,)
```

```{r}
Deshmukh_norm_GSEA=gsePathway(Deshmukh_df_norm%>%select(ENTREZID,Deshmukh_logFC)%>%arrange(desc(Deshmukh_logFC))%>%deframe(),organism = "human",minGSSize = 30,pvalueCutoff = 0.25)
```


```{r}
gseaplot2(Deshmukh_norm_GSEA,geneSetID = unlist(Deshmukh_norm_GSEA@result$ID)[c(2,3,4,8)],subplots = 1,title = "Deshmukh Normalized Mitochondria Intensities")
```

```{r}
NVT_GSEA=gsePathway(Granata_NVT%>%select(ENTREZID,NVT_Granata_logFC)%>%arrange(desc(NVT_Granata_logFC))%>%deframe(),organism = "human",minGSSize = 30,pvalueCutoff = 0.25)
HVT_GSEA=gsePathway(Granata_HVT%>%select(ENTREZID,HVT_Granata_logFC)%>%arrange(desc(HVT_Granata_logFC))%>%deframe(),organism = "human",minGSSize = 30,pvalueCutoff = 0.25)
```

```{r}
NVT_norm=gsePathway(Granata_NVT_norm%>%select(ENTREZID,NVT_Granata_logFC)%>%arrange(desc(NVT_Granata_logFC))%>%deframe(),organism = "human",minGSSize = 30,pvalueCutoff = 0.25)
HVT_norm=gsePathway(Granata_HVT_norm%>%select(ENTREZID,HVT_Granata_logFC)%>%arrange(desc(HVT_Granata_logFC))%>%deframe(),organism = "human",minGSSize = 30,pvalueCutoff = 0.25)
```

```{r}
NVT_norm_GSEGO=gseGO(Granata_NVT_norm%>%select(ENTREZID,NVT_Granata_logFC)%>%arrange(desc(NVT_Granata_logFC))%>%deframe(),ont = "BP",OrgDb = org.Hs.eg.db,pAdjustMethod = "BH",minGSSize = 30,pvalueCutoff = 0.25)
```


```{r}
#gseaplot2(NVT_GSEA,geneSetID = unlist(NVT_GSEA@result$ID),subplots = 1)
png("Granata_HVT_norm_GSEA.png",width = 10,height = 7,units = "in",res=400)
gseaplot2(HVT_norm,geneSetID = unlist(HVT_norm@result$ID)[c(16,13,11,9,3)],subplots = 1,title = "HVT Mitochondrial Normalized data")
dev.off()
```


```{r}
png("NVT_GSEA.png",width = 10,height = 7,units = "in",res=400)
gseaplot2(NVT_GSEA,geneSetID = unlist(NVT_GSEA@result$ID),subplots = 1,title = "NVT whole data")
dev.off()
```

```{r}
png("HVT_GSEA.png",width = 10,height = 7,units = "in",res=400)
gseaplot2(HVT_GSEA,geneSetID = unlist(HVT_GSEA@result$ID)[c(1:7,9)],subplots = 1,title = "HVT whole data")
dev.off()
```


```{r}
EnhancedVolcano(Granata_HVT,x="HVT_Granata_logFC",y="HVT_Granata_sca.P.Value",lab = Granata_HVT$Gene, pCutoff = 0.01,FCcutoff = 0.5,colAlpha = 0.8,pointSize = 1.5,drawConnectors = T,max.overlaps = 20,labSize = 1.5,axisLabSize = 10)
```

```{r}
png("../Deshmukh_2021_analysis/Mito Normalized Enhanced Volcano",height = 5,width = 6,units = "in",res = 600)
EnhancedVolcano(Deshmukh_df_norm,x="Deshmukh_logFC",y="Deshmukh_sca.P.Value",lab = Deshmukh_df_norm$Gene, pCutoff = 0.01,FCcutoff = 0.5,colAlpha = 0.8,pointSize = 1.5,drawConnectors = T,max.overlaps = 20,labSize = 1.5,axisLabSize = 10,title = "",subtitle = "",legendIconSize = 5,legendLabSize = 5,ylim=c(0,4))
dev.off()
```

```{r}
gseaplot2(NVT_norm,geneSetID = unlist(NVT_norm@result$ID)[c(1,2)],subplots = 1,title = "Granata Normalized Intensities")
```

```{r}
gseaplot2(NVT_GSEA,geneSetID = unlist(NVT_GSEA@result$ID),subplots = 1,title = "")
```

```{r}
MCIT_GSEA=gsePathway(Javi_MCIT%>%distinct(ENTREZID,.keep_all = T)%>%select(ENTREZID,Javi_MCIT_logFC)%>%arrange(desc(Javi_MCIT_logFC))%>%deframe(),organism = "human",minGSSize = 30,pvalueCutoff = 0.25)
```

```{r}
SIT_GSEA=gsePathway(Javi_SIT%>%distinct(ENTREZID,.keep_all = T)%>%select(ENTREZID,Javi_SIT_logFC)%>%arrange(desc(Javi_SIT_logFC))%>%deframe(),organism = "human",minGSSize = 30,pvalueCutoff = 0.25)
```

```{r}
Hostrup_GSEA=gsePathway(Hostrup_df_norm%>%distinct(ENTREZID,.keep_all = T)%>%select(ENTREZID,Hostrup_logFC)%>%arrange(desc(Hostrup_logFC))%>%deframe(),organism = "human",minGSSize = 30,pvalueCutoff = 0.25,pAdjustMethod = "BH")
```

```{r}
gseaplot2(Deshmukh_norm_GSEA,geneSetID = unlist(Deshmukh_norm_GSEA@result$ID),subplots = 1,title = "Hostrup Normalized intensities")
```

```{r}
MCIT_GSEA_GO=gseGO(Javi_MCIT%>%distinct(ENTREZID,.keep_all = T)%>%select(ENTREZID,Javi_MCIT_logFC)%>%arrange(desc(Javi_MCIT_logFC))%>%deframe(),ont = "BP",OrgDb = org.Hs.eg.db,pAdjustMethod = "BH",pvalueCutoff = 0.25,minGSSize = 30)
```

```{r}
SIT_GSEA_GO=gseGO(Javi_SIT%>%distinct(ENTREZID,.keep_all = T)%>%select(ENTREZID,Javi_SIT_logFC)%>%arrange(desc(Javi_SIT_logFC))%>%deframe(),ont = "BP",OrgDb = org.Hs.eg.db,pAdjustMethod = "BH",pvalueCutoff = 0.25,minGSSize = 30)
```
 
No enriched terms found for GSEA in SIT in either GO or Reactome, however MCIT is enriched and GO is able to look deeper into the enriched terms. For example, is able to discern enrichment of fatty acid metab process over simply metabolism 

```{r}
gseaplot2(MCIT_GSEA_GO,geneSetID = unlist(MCIT_GSEA_GO@result$ID)[c(10,13,5,14,12)],subplots = 1,title = "MCIT whole intensities")
```

```{r}
Granata_NVT_compare_list_unnorm=list(names(Granata_NVT%>%filter(NVT_Granata_sca.P.Value<=0.01 & NVT_Granata_logFC>0)%>%select(ENTREZID,NVT_Granata_logFC)%>%deframe()),names(Granata_NVT%>%filter(NVT_Granata_sca.P.Value<=0.01 & NVT_Granata_logFC<0)%>%select(ENTREZID,NVT_Granata_logFC)%>%deframe()))
names(Granata_NVT_compare_list_unnorm)=c("Upregulated","Downregulated")
```

```{r}
Granata_HVT_compare_list_norm=list(names(Granata_HVT_norm%>%filter(HVT_Granata_sca.P.Value<=0.01 & HVT_Granata_logFC>0)%>%select(ENTREZID,HVT_Granata_logFC)%>%deframe()),names(Granata_HVT_norm%>%filter(HVT_Granata_sca.P.Value<=0.01 & HVT_Granata_logFC<0)%>%select(ENTREZID,HVT_Granata_logFC)%>%deframe()))
names(Granata_HVT_compare_list_norm)=c("Upregulated","Downregulated")
```

```{r}
Granata_HVT_compare_list_unnorm=list(names(Granata_HVT%>%filter(HVT_Granata_sca.P.Value<=0.01 & HVT_Granata_logFC>0)%>%select(ENTREZID,HVT_Granata_logFC)%>%deframe()),names(Granata_HVT%>%filter(HVT_Granata_sca.P.Value<=0.01 & HVT_Granata_logFC<0)%>%select(ENTREZID,HVT_Granata_logFC)%>%deframe()))
names(Granata_HVT_compare_list_unnorm)=c("Upregulated","Downregulated")
```

```{r}
Granata_HVT_norm_compare_list=list(Granata_HVT_compare_list_norm$Upregulated,Granata_HVT_compare_list_norm$Downregulated,Granata_HVT_compare_list_unnorm$Upregulated)
names(Granata_HVT_norm_compare_list)=c('Norm_up','Norm_down','Whole_up')
```


```{r}
Granata_NVT_norm_compare_list=list(Granata_NVT_compare_list_norm$Upregulated,Granata_NVT_compare_list_norm$Downregulated,Granata_NVT_compare_list_unnorm$Upregulated)
names(Granata_NVT_norm_compare_list)=c('Norm_up','Norm_down','Whole_up')
```


```{r}
#HVT_compare=compareCluster(geneClusters=Granata_HVT_compare_list,fun = "enrichGO",ont="BP",readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.01,minGSSize=30)
```

```{r}
NVT_compare_norm=compareCluster(geneClusters=Granata_NVT_norm_compare_list,fun = "enrichGO",ont="BP",readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
NVT_compare_norm_Reactome=compareCluster(geneClusters=Granata_NVT_norm_compare_list,fun = "enrichPathway",readable=T,organism='human',pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
HVT_compare_norm=compareCluster(geneClusters=Granata_HVT_norm_compare_list,fun = "enrichGO",ont="BP",readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
HVT_compare_norm_Reactome=compareCluster(geneClusters=Granata_HVT_norm_compare_list,fun = "enrichPathway",readable=T,organism='human',pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```


```{r}
dotplot(NVT_compare_norm,includeAll=T,font.size=7,showCategory=20,title="Granata NVT Compare")
```

```{r}
dotplot(NVT_compare_norm_Reactome,includeAll=T,font.size=7,showCategory=20,title="Granata NVT Compare")
```


```{r}
dotplot(HVT_compare_norm_Reactome,includeAll=T,font.size=7,showCategory=20,title="Granata HVT Compare Reactome")
```


```{r}
Hostrup_compare_list=list(names(Hostrup_df_norm%>%filter(Hostrup_sca.P.Value<=0.01 & Hostrup_logFC>0)%>%select(ENTREZID,Hostrup_logFC)%>%deframe()),names(Hostrup_df_norm%>%filter(Hostrup_sca.P.Value<=.01 & Hostrup_logFC<0)%>%select(ENTREZID,Hostrup_logFC)%>%deframe()))
names(Hostrup_compare_list)=c("Upregulated","Downregulated")
```

```{r}
Hostrup_compare_list_unnorm=list(names(Hostrup_df%>%filter(Hostrup_sca.P.Value<=0.01 & Hostrup_logFC>0)%>%select(ENTREZID,Hostrup_logFC)%>%deframe()),names(Hostrup_df%>%filter(Hostrup_sca.P.Value<=.01 & Hostrup_logFC<0)%>%select(ENTREZID,Hostrup_logFC)%>%deframe()))
names(Hostrup_compare_list_unnorm)=c("Upregulated","Downregulated")
```



```{r}
MCIT_norm_list=list(names(Javi_MCIT_norm%>%filter(Javi_MCIT_logFC>0 & Javi_MCIT_sca.P.Value<=0.01)%>%select(ENTREZID,Javi_MCIT_logFC)%>%deframe()),names(Javi_MCIT_norm%>%filter(Javi_MCIT_logFC<0 & Javi_MCIT_sca.P.Value<=0.01)%>%select(ENTREZID,Javi_MCIT_logFC)%>%deframe()))
names(MCIT_norm_list)=c("Upregulated","Downregulated")
```

```{r}
MCIT_list=list(names(Javi_MCIT%>%filter(Javi_MCIT_logFC>0 & Javi_MCIT_sca.P.Value<=0.01)%>%select(ENTREZID,Javi_MCIT_logFC)%>%deframe()),names(Javi_MCIT%>%filter(Javi_MCIT_logFC<0 & Javi_MCIT_sca.P.Value<=0.01)%>%select(ENTREZID,Javi_MCIT_logFC)%>%deframe()))
names(MCIT_list)=c("Upregulated","Downregulated")
```


```{r}
SIT_list=list(names(Javi_SIT%>%filter(Javi_SIT_logFC>0 & Javi_SIT_sca.P.Value<=0.01)%>%select(ENTREZID,Javi_SIT_logFC)%>%deframe()),names(Javi_SIT%>%filter(Javi_SIT_logFC<0 & Javi_SIT_sca.P.Value<=0.01)%>%select(ENTREZID,Javi_SIT_logFC)%>%deframe()))
names(SIT_list)=c("Upregulated","Downregulated")
```

```{r}
SIT_norm_list=list(names(Javi_SIT_norm%>%filter(Javi_SIT_logFC>0 & Javi_SIT_sca.P.Value<=0.01)%>%select(ENTREZID,Javi_SIT_logFC)%>%deframe()),names(Javi_SIT_norm%>%filter(Javi_SIT_logFC<0 & Javi_SIT_sca.P.Value<=0.01)%>%select(ENTREZID,Javi_SIT_logFC)%>%deframe()))
names(SIT_norm_list)=c("Upregulated","Downregulated")
```


```{r}
Hostrup_compare=compareCluster(geneClusters=Hostrup_compare_list,fun = "enrichGO",ont="BP",readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
Hostrup_compare_unnorm=compareCluster(geneClusters=Hostrup_compare_list_unnorm,fun = "enrichGO",ont="BP",readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
Hostrup_list_2=list(Hostrup_compare_list$Upregulated,Hostrup_compare_list_unnorm$Upregulated)
names(Hostrup_list_2)=c('Normalized','Whole')
```


```{r}
Hostrup_compare_normalizations=compareCluster(geneClusters=Hostrup_list_2,fun = "enrichGO",ont="BP",readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
Hostr
```

```{r}
dotplot(Hostrup_compare,includeAll=T,font.size=7,showCategory=15,title="Hostrup Mito normalized DE")
```

```{r}
dotplot(Hostrup_compare_unnorm,includeAll=T,font.size=7,showCategory=15,title="Hostrup Mito whole DE")
```

```{r}
dotplot(Hostrup_compare_normalizations,includeAll=T,font.size=7,showCategory=20,title="Compare Normalization")
```

```{r}
Hostrup_compare_Reactome=compareCluster(geneClusters = Hostrup_list_2,fun = "enrichPathway",readable=T,organism="human",pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
SIT_norm_compare_Reactome=compareCluster(geneClusters = SIT_norm_list,fun = "enrichPathway",readable=T,organism="human",pvalueCutoff=0.05)
```


```{r}
dotplot(NVT_compare,includeAll=T,font.size=7,showCategory=15,title="NVT Mitochondria normalized D.E")
dotplot(HVT_compare,includeAll=T,font.size=7,showCategory=15,title="HVT Mitochondria normalized D.E")
```

```{r}
dotplot(Hostrup_compare_Reactome,includeAll=T,font.size=7,showCategory=15,title="Hostrup Normalisation Compare")
```

No evidence of deprioritization found after normalization, as reported and found in Granata et.al, in the Hostrup dataset even though downregulated genes have been found and the size of the set is the same as the upregulated ones


```{r}
normalized_compare_list=list(Granata_NVT_compare_list$Upregulated,Granata_HVT_compare_list$Upregulated,MCIT_norm_list$Upregulated,Deshmukh_compare$Upregulated,Hostrup_compare_list$Upregulated)
names(normalized_compare_list)=c("Granata_NVT","Granata_HVT","Javi_MCIT","Deshmukh et.al","Hostrup et.al")
```

```{r}
normalized_compare_list_downregulated=list(Granata_NVT_compare_list$Downregulated,Granata_HVT_compare_list$Downregulated,MCIT_norm_list$Downregulated,Deshmukh_compare$Downregulated,Hostrup_compare_list$Downregulated)
names(normalized_compare_list_downregulated)=c("Granata_NVT","Granata_HVT","Javi_MCIT","Deshmukh et.al","Hostrup et.al")
```

```{r}
upregulated_all=list(SIT_list$Upregulated,Granata_NVT_compare_list_unnorm$Upregulated,Granata_HVT_compare_list_unnorm$Upregulated,MCIT_list$Upregulated,Deshmukh_compare_whole$Upregulated,Hostrup_compare_list_unnorm$Upregulated)
names(upregulated_all)=c('Javi_SIT',"Granata_NVT","Granata_HVT","Javi_MCIT","Deshmukh et.al","Hostrup et.al")
```

```{r}
Compare_all_upregulated_whole=compareCluster(geneClusters = upregulated_all,fun = "enrichPathway",readable=T,organism="human",pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
Compare_all_upregulated_whole_GO=compareCluster(geneClusters = upregulated_all,fun='enrichGO',readable=T,ont='BP',pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID,OrgDb=org.Hs.eg.db)
```


```{r}
Compare_all_upregulated_whole_GO_CC=compareCluster(geneClusters = upregulated_all,fun='enrichGO',readable=T,ont='CC',pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID,OrgDb=org.Hs.eg.db)
```

```{r}
dotplot(Compare_all_upregulated_whole,includeAll=T,font.size=9,showCategory=25,title="Compare Mito protein upregulation")
```

```{r}
dotplot(Compare_all_upregulated_whole_GO,includeAll=T,font.size=4,showCategory=30,title="Compare Mito protein upregulation")
```


```{r}
Normalized_Compare_GO_downregulated=compareCluster(geneClusters = normalized_compare_list_downregulated,fun = "enrichGO",ont="BP",readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.01,minGSSize=30)
```


```{r}
Normalized_Compare_reactome=compareCluster(geneClusters = normalized_compare_list,fun = "enrichPathway",readable=T,organism="human",pvalueCutoff=0.01,minGSSize=30)
```



```{r}    
SIT_compare_Reactome=compareCluster(geneClusters = SIT_list,fun = "enrichPathway",readable=T,organism="human",pvalueCutoff=0.01,minGSSize=30)
```

```{r}
SIT_norm_compare_GO=compareCluster(geneClusters = SIT_norm_list,fun = "enrichGO",ont="BP",readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=.01,minGSSize=30)
```

```{r}
dotplot(SIT_norm_compare_GO,includeAll=T,font.size=9,showCategory=15,title="SIT Normalized Mitochondria Enrichment")
```


```{r}
Deshmukh_compare_Reactome=compareCluster(geneClusters = Deshmukh_compare,fun = "enrichPathway",readable=T,organism="human",pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
Deshmukh_compare_GO=compareCluster(geneClusters = Deshmukh_compare,fun = "enrichGO",ont="BP",readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}  
compareCluster(geneClusters = MCIT_list,fun = "enrichPathway",readable=T,organism="human",pvalueCutoff=.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
MCIT_norm_compare=compareCluster(geneClusters = MCIT_norm_list,fun = "enrichPathway",readable=T,organism="human",pvalueCutoff=.05,minGSSize=20,maxGSSize=200)
```

```{r}
MCIT_norm_compare_GO=compareCluster(geneClusters = MCIT_norm_list,fun = "enrichGO",ont="BP",OrgDb=org.Hs.eg.db,readable=T,pvalueCutoff=.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
Javi_norm_compare_GO=compareCluster(geneClusters = Javi_list,fun ="enrichGO",ont="BP",OrgDb=org.Hs.eg.db,readable=T,pvalueCutoff=.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
Javi_norm_compare_Reactome=compareCluster(geneClusters = Javi_list,fun ="enrichPathway",organism='human',readable=T,pvalueCutoff=.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
Javi_whole_compare_list=list(SIT_list$Upregulated,SIT_list$Downregulated,MCIT_list$Upregulated,MCIT_list$Downregulated)
names(Javi_whole_compare_list)=c('SIT_up','SIT_down','MCIT_up','MCIT_down')
```

```{r}
Javi_whole_compare_GO=compareCluster(geneClusters = Javi_whole_compare_list,fun ="enrichGO",ont="BP",OrgDb=org.Hs.eg.db,readable=T,pvalueCutoff=.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
Javi_whole_compare_Reactome=compareCluster(geneClusters = Javi_whole_compare_list,fun ="enrichPathway",organism='human',readable=T,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
dotplot(Javi_whole_compare_GO,includeAll=T,font.size=8,showCategory=15,title="")
```

```{r}
dotplot(Deshmukh_compare_GO,includeAll=T,font.size=8,showCategory=15,title='')
```


```{r}
dotplot(MCIT_norm_compare_GO,includeAll=T,font.size=8,showCategory=15,title="")
```

```{r}
dotplot(Javi_norm_compare_Reactome,includeAll=T,font.size=8,showCategory=15,title="Javi data Normalized compare")
```



```{r}
Schild_Reactome_GSEA=gsePathway(Schild_df%>%distinct(ENTREZID,.keep_all = T)%>%select(ENTREZID,Schild_2015_logFC)%>%arrange(desc(Schild_2015_logFC))%>%deframe(),organism = "human",minGSSize = 30,pvalueCutoff = 0.25)
```

```{r}
gseaplot2(Schild_Reactome_GSEA,geneSetID = unlist(Schild_Reactome_GSEA@result$ID)[c(4,5,6,7)],subplots = 1,title = "Schild Whole Intensities")
```


```{r}
result=MCIT_compare@compareClusterResult
```

```{r}
#Popov_results=readRDS("../Popov analysis/DEqMS_Popov_unnorm")
```

```{r}
Whole_v_norm_down=setdiff(MCIT_norm_list$Downregulated,MCIT_list$Downregulated)
```

```{r}
Norm_down_v_Whole_up=intersect(Hostrup_compare_list$Downregulated,Hostrup_compare_list_unnorm$Upregulated)
```

```{r}
Norm_down_v_Whole_up_Deshmukh=intersect(Deshmukh_compare$Downregulated,Deshmukh_compare_whole$Upregulated)
```

```{r}
Deshmukh_comapre_normalisation_list=list(Deshmukh_compare$Upregulated,Deshmukh_compare$Downregulated,Deshmukh_compare_whole$Upregulated)
names(Deshmukh_comapre_normalisation_list)=c('Norm_up','Norm_down','Whole_up')
```

```{r}
Deshmukh_compare_norm_GO=compareCluster(geneClusters = Deshmukh_comapre_normalisation_list,fun = "enrichGO",ont="BP",readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
dotplot(Deshmukh_compare_norm_GO,includeAll=T,font.size=8,showCategory=20,title='')
```

```{r}
SIT_only_ENTREZ=mapIds(x=org.Hs.eg.db,keys = SIT_only_genes,keytype = 'SYMBOL',column = 'ENTREZID')
```

```{r}
Unique_DIA_Entrez=mapIds(x=org.Hs.eg.db,keys = Unique_DIA,keytype = 'SYMBOL',column = 'ENTREZID')
```

```{r}
meta_sig_Entrez=mapIds(x=org.Hs.eg.db,keys = meta_sig_genes,keytype = 'SYMBOL',column = 'ENTREZID')
```

```{r}
meta_Reactome=enrichPathway(meta_sig_Entrez,readable=T,organism = 'human',pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
dotplot(meta_Reactome,font.size=8,showCategory=30,title='')
```

```{r}
SIT_only_GO=enrichGO(SIT_only_ENTREZ,ont="BP",readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
Unique_DIA_GO=enrichGO(Unique_DIA_Entrez,ont="CC",readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID,level=5)
```

```{r}
Unique_DIA_Reactome=enrichPathway(Unique_DIA_Entrez,readable=T,organism = 'human',pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
only_Hostrup_sig=readRDS('../Meta_analysis_code/Only_Hostrup_sig')
```


```{r}
only_Hostrup_sig_ENTREZ=mapIds(x=org.Hs.eg.db,keys = only_Hostrup_sig,keytype = 'SYMBOL',column = 'ENTREZID')
```

```{r}
only_NVT_sig_ENTREZ=mapIds(x=org.Hs.eg.db,keys = only_NVT_sig,keytype = 'SYMBOL',column = 'ENTREZID')
```

```{r}
only_HVT_sig_ENTREZ=mapIds(x=org.Hs.eg.db,keys = only_HVT_sig,keytype = 'SYMBOL',column = 'ENTREZID')
```


```{r}
only_Hostrup_sig_GO=enrichGO(only_Hostrup_sig_ENTREZ,ont='CC',readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
Deshmukh_CC=enrichGO(Deshmukh_comapre_normalisation_list$Whole_up,ont='CC',readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
only_NVT_sig_CC=enrichGO(only_NVT_sig_ENTREZ,ont='CC',readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
only_HVT_sig_CC=enrichGO(only_HVT_sig_ENTREZ,ont='CC',readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```


```{r}
only_Hostrup_sig_reactome=enrichPathway(only_Hostrup_sig_ENTREZ,readable=T,organism = 'human',pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```


```{r}
dotplot(Compare_all_upregulated_whole_GO_CC,font.size=8,showCategory=60,title='')
```

```{r}
Hostrup_only_sig_fc=Hostrup_df%>%filter(Gene %in% only_Hostrup_sig)%>%dplyr::select(ENTREZID,Hostrup_logFC)%>%deframe()
```

```{r}
Deshmukh_sig_fc=Deshmukh_df%>%filter(ENTREZID %in% Deshmukh_compare_whole$Upregulated)%>%dplyr::select(ENTREZID,Deshmukh_logFC)%>%deframe()
```


```{r}
cnetplot(Deshmukh_CC,params=list(category_label=.5,gene_label=.5,category_node=.7),foldChange=Deshmukh_sig_fc)
```


```{r}
png('Cnet_plot_all_upregulated.png',width = 8,height = 8,units = 'in',res = 800)
cnetplot(Compare_all_upregulated_whole,max.overalps=30,params=list(category_label=.5,gene_label=.5,category_node=.7))
dev.off()
```


```{r}
cnetplot(only_Hostrup_sig_GO,cex.params=list(category_label=.5,gene_label=.5,category_node=.7),foldChange=Hostrup_only_sig_fc,sh)
```


```{r}
only_MCIT_sig=readRDS('../Meta_analysis_code/only_MCIT_sig')
```

```{r}
only_MCIT_sig_ENTREZ=mapIds(x=org.Hs.eg.db,keys = only_MCIT_sig,keytype = 'SYMBOL',column = 'ENTREZID')
```

```{r}
MCIT_CC=enrichGO(Javi_whole_compare_list$MCIT_up,ont='CC',readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
Hostrup_Deshmukh_Compare_CC=compareCluster(list(Deshmukh_et.al=upregulated_all$`Deshmukh et.al`,Hostrup_et.al=only_Hostrup_sig_ENTREZ),ont='CC',fun = 'enrichGO',readable=T,OrgDb=org.Hs.eg.db,pvalueCutoff=0.05,minGSSize=20,maxGSSize=200,universe=background_map_Uniprot$ENTREZID)
```

```{r}
cnetplot(Hostrup_Deshmukh_Compare_CC,cex.params=list(category_label=.7,gene_label=.7,category_node=.7))
```


```{r}
only_HVT_df=Granata_HVT%>%filter(Gene %in% only_HVT_sig)
only_NVT_df=Granata_NVT%>%filter(Gene %in% only_NVT_sig)
only_MCIT_df=Javi_MCIT%>%filter(Gene %in% only_MCIT_sig)
```

```{r}
dotplot(MCIT_CC,showCategory=20)
cnetplot(MCIT_CC@compareClusterResult%>%filter(Cluster=='MCIT_up'))
```

